{"version":3,"file":"static/js/13.5fe4313e.chunk.js","mappings":"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","sources":["Activities/Upload.tsx","Shared/components/Loading.tsx","Shared/components/Mapbox.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\n\nimport { Loading } from \"../Shared/components\";\nimport { Box, Button, Heading, Text } from \"@primer/react\";\nimport { createUseStyles } from \"react-jss\";\n\ntype SignedURL = {\n  uploadURL: string;\n};\n\nconst baseUrl = process.env.REACT_APP_BASE_API_URL;\n\nconst useStyles = createUseStyles({\n  container: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    width: \"100%\",\n  },\n  content: {\n    width: \"calc(100% - 2rem)\",\n    maxWidth: \"30rem\",\n  },\n  actions: {\n    display: \"flex\",\n    flexWrap: \"wrap\",\n    justifyContent: \"space-between\",\n  },\n  fileInput: {\n    marginTop: \"1rem\",\n    marginBottom: \"1rem\",\n  },\n  actionBtn: {\n    minWidth: \"calc(50% - 0.5rem)\",\n    marginBottom: \"1rem\",\n  },\n});\n\nconst Upload = () => {\n  const navigate = useNavigate();\n  const classes = useStyles();\n\n  const [loading, setLoading] = useState<boolean>(false);\n  const [file, setFile] = useState<File>();\n\n  function handleFileInput(event: React.ChangeEvent<HTMLInputElement>) {\n    const uploadedFile = event.target.files?.item(0);\n\n    if (uploadedFile) {\n      setFile(uploadedFile);\n    }\n  }\n\n  async function handleSubmit() {\n    if (file) {\n      setLoading(true);\n      const params = new URLSearchParams();\n      params.append(\"filename\", file.name);\n\n      const uploadResponse: Response = await fetch(\n        baseUrl + \"/upload?\" + params.toString()\n      );\n      const response: SignedURL = await uploadResponse.json();\n\n      await fetch(response.uploadURL, {\n        method: \"PUT\",\n        headers: {\n          \"Content-Type\": \"binary/octet-stream\",\n        },\n        body: file,\n      });\n\n      setLoading(false);\n      navigate(\"/activities\");\n    }\n  }\n\n  return (\n    <form className={classes.container}>\n      <div className={classes.content}>\n        <Heading\n          id=\"inputGroupFileAddon01\"\n          sx={{\n            marginTop: 16,\n          }}\n        >\n          Upload\n        </Heading>\n\n        <Text>Accepted file types: '.gpx'</Text>\n        <div className={classes.fileInput}>\n          <input\n            type=\"file\"\n            id=\"myFile\"\n            name=\"filename\"\n            onChange={handleFileInput}\n          />\n        </div>\n\n        <Box display=\"flex\">\n          <Link to=\"/activities\">\n            <Button type=\"button\">Go Back</Button>\n          </Link>\n          <Button\n            variant=\"primary\"\n            type=\"submit\"\n            onClick={handleSubmit}\n            disabled={!file}\n          >\n            Submit\n          </Button>\n        </Box>\n        {loading && <Loading />}\n      </div>\n    </form>\n  );\n};\n\nexport default Upload;\n","import { createUseStyles } from \"react-jss\";\n\nimport { Spinner } from \"@primer/react\";\n\nconst useStyles = createUseStyles({\n  container: {\n    width: \"100%\",\n    display: \"flex\",\n    justifyContent: \"center\",\n    margin: \"2rem 0\",\n  },\n});\n\nexport const Loading = () => {\n  const css = useStyles();\n\n  return (\n    <div className={css.container}>\n      <Spinner size=\"large\" />\n    </div>\n  );\n};\n","import { useCallback, useEffect, useRef } from \"react\";\n\nimport { useTheme } from \"@primer/react\";\n\n/**\n * '!mapbox-gl' is a workaround to ES6 compilation errors.\n * @see https://github.com/mapbox/mapbox-gl-js/issues/10565\n */\n// @ts-ignore\n// eslint-disable-next-line\nimport mapboxgl from \"!mapbox-gl\";\nimport * as mapboxPoly from \"@mapbox/polyline\";\nimport { createUseStyles } from \"react-jss\";\n\nconst getBoundingBox = (coords: any[]) => {\n  const bbox = [\n    Number.POSITIVE_INFINITY,\n    Number.POSITIVE_INFINITY,\n    Number.NEGATIVE_INFINITY,\n    Number.NEGATIVE_INFINITY,\n  ];\n\n  return coords.reduce((prev, coord) => {\n    return [\n      Math.min(coord[0], prev[0]),\n      Math.min(coord[1], prev[1]),\n      Math.max(coord[0], prev[2]),\n      Math.max(coord[1], prev[3]),\n    ];\n  }, bbox);\n};\n\nconst useStyles = createUseStyles({\n  map: {\n    height: \"25rem\",\n  },\n});\n\ntype MapboxProps = {\n  polyline: string;\n};\n\nexport const Mapbox = ({ polyline }: MapboxProps) => {\n  const mapContainer = useRef(null);\n  const css = useStyles();\n  const theme = useTheme();\n\n  const setupMap = useCallback(() => {\n    const geojson = mapboxPoly.toGeoJSON(polyline);\n    const bounds = getBoundingBox(geojson.coordinates);\n    const mapStyle =\n      theme.colorMode === \"night\"\n        ? \"mapbox://styles/mapbox/dark-v10\"\n        : \"mapbox://styles/mapbox/outdoors-v11\";\n\n    const map = new mapboxgl.Map({\n      container: mapContainer.current || \"\",\n      style: mapStyle,\n      bounds: new mapboxgl.LngLatBounds(bounds),\n      fitBoundsOptions: {\n        padding: {\n          top: 40,\n          bottom: 40,\n          left: 40,\n          right: 40,\n        },\n      },\n      accessToken: process.env.REACT_APP_MAPBOX_PUBLIC_KEY,\n    });\n\n    // Add map controls\n    map.addControl(new mapboxgl.NavigationControl());\n    map.scrollZoom.disable();\n\n    map.on(\"load\", () => {\n      map.addSource(\"route\", {\n        type: \"geojson\",\n        data: {\n          type: \"Feature\",\n          properties: {},\n          geometry: {\n            type: \"LineString\",\n            coordinates: geojson.coordinates,\n          },\n        },\n      });\n      map.addLayer({\n        id: \"route\",\n        type: \"line\",\n        source: \"route\",\n        layout: {\n          \"line-join\": \"round\",\n          \"line-cap\": \"round\",\n        },\n        paint: {\n          \"line-color\": \"#008DD5\",\n          \"line-width\": 4,\n        },\n      });\n    });\n  }, [theme.colorMode, polyline]);\n\n  useEffect(() => {\n    setupMap();\n  }, [setupMap]);\n\n  return <div ref={mapContainer} className={css.map}></div>;\n};\n"],"names":["baseUrl","process","useStyles","createUseStyles","container","display","justifyContent","width","content","maxWidth","actions","flexWrap","fileInput","marginTop","marginBottom","actionBtn","minWidth","navigate","useNavigate","classes","useState","loading","setLoading","file","setFile","params","URLSearchParams","append","name","fetch","toString","uploadResponse","json","response","uploadURL","method","headers","body","className","id","sx","type","onChange","event","uploadedFile","target","files","item","to","variant","onClick","disabled","margin","Loading","css","Spinner","size","map","height","Mapbox","polyline","mapContainer","useRef","theme","useTheme","setupMap","useCallback","geojson","mapboxPoly","bounds","coords","bbox","Number","POSITIVE_INFINITY","NEGATIVE_INFINITY","reduce","prev","coord","Math","min","max","getBoundingBox","coordinates","mapStyle","colorMode","mapboxgl","current","style","fitBoundsOptions","padding","top","bottom","left","right","accessToken","addControl","scrollZoom","disable","on","addSource","data","properties","geometry","addLayer","source","layout","paint","useEffect","ref"],"sourceRoot":""}