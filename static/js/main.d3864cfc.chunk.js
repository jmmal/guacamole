(this.webpackJsonpguacamole=this.webpackJsonpguacamole||[]).push([[0],{276:function(e,t,a){e.exports=a(472)},281:function(e,t,a){},472:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(69),c=a.n(i),l=(a(281),a(52)),o=a(28),m=a(15),u=a(108),s=a(492),d=function(e){var t=e.onFilterChange,a=function(){var e=Object(n.useState)([]),t=Object(m.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){fetch("/filters").then((function(e){return e.json()})).then((function(e){return r(e)}))}),[]),{filters:a}}().filters,i=Object(n.useState)(),c=Object(m.a)(i,2),l=c[0],o=c[1],d=Object(n.useState)([]),f=Object(m.a)(d,2),p=f[0],v=f[1];Object(n.useEffect)((function(){if(0!==a.length){var e=a.reduce((function(e,t){return e+t.total}),0),t={label:"All (".concat(e,")"),value:"All"},n=[t].concat(Object(u.a)(a.map((function(e){return{label:e.type+" (".concat(e.total,")"),value:e.type}}))));o(t),v(n)}}),[a]);return r.a.createElement(s.a,{a11yTitle:"Filter by activity type",options:p,labelKey:"label",placeholder:"-",value:l,size:"small",onChange:function(e){console.log(e.option),o(e.option),t(e.option.value)}})},f=a(491),p=function(e){var t=Math.floor(e/60),a="".concat(Math.floor(e-60*t));return"".concat(t,":").concat(a.padStart(2,"0"))},v=function(e){var t=Math.floor(e/60),a=Math.floor(t/60),n=Math.floor(e-60*t);return a>=1?"".concat(a,"h ").concat(t%60,"m"):"".concat(t,"m ").concat(n,"s")},E=a(40),h=a(236),b=Object(E.a)({container:{width:"100%",display:"flex",justifyContent:"center",margin:"2rem 0"}}),g=function(){var e=b();return r.a.createElement("div",{className:e.container},r.a.createElement(h.BeatLoader,{size:"30px",margin:"4px",color:"#7D4CDB"}))},y=a(133),j=a(237),w=Object(E.a)({map:{height:"25rem"}}),N=function(e){var t=e.polyline,a=Object(n.useRef)(null),i=w();Object(n.useEffect)((function(){c()}));var c=function(){var e=j.toGeoJSON(t),n=function(e){var t=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return e.reduce((function(e,t){return[Math.min(t[0],e[0]),Math.min(t[1],e[1]),Math.max(t[0],e[2]),Math.max(t[1],e[3])]}),t)}(e.coordinates),r=new y.Map({container:a.current||"",style:"mapbox://styles/mapbox/outdoors-v11",bounds:new y.LngLatBounds(n),fitBoundsOptions:{padding:{top:40,bottom:40,left:40,right:40}},accessToken:"pk.eyJ1Ijoiam1tYWwiLCJhIjoiY2tobXJhbHpqMHZmYTJwbnVwY21oaXl6byJ9.CZy7LN4IJff9dD5-orrPHw"});r.addControl(new y.NavigationControl),r.scrollZoom.disable(),r.on("load",(function(){r.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:e.coordinates}}}),r.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#008DD5","line-width":4}})}))};return r.a.createElement("div",{ref:a,className:i.map})},O=a(501),x=a(500),k=a(499),D=Object(E.a)({image:{width:"100%"},preview:{borderRadius:3,border:"1px solid #e2e2e2",boxShadow:"0px 8px 24px rgba(13,13,18,0.04)",padding:"1rem 1rem 1rem 1rem",marginBottom:"1rem"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",marginBottom:"0.5rem"}}),I=function(e){var t,a,n,i=e.activity,c=e.index,l=Object(o.f)(),m=D();function u(){l.push("/activities/".concat(i._id))}return r.a.createElement("article",{className:m.preview,"aria-posinset":c,tabIndex:0,onClick:u,onKeyDown:function(e){"ENTER"===e.key&&u()}},r.a.createElement("div",{className:m.header},r.a.createElement(O.a,{margin:"none",level:"4"},Object(f.a)(new Date(i.startTime),"EEEE, LLLL d, yyyy")),r.a.createElement(x.a,null,i.title)),i.imageURL&&r.a.createElement("img",{src:i.imageURL,alt:"Activity GPS preview",className:m.image}),r.a.createElement(k.a,{direction:"row",justify:"between"},r.a.createElement(S,{title:"Distance",value:"".concat(Number(i.distance/1e3).toFixed(2)," km")}),r.a.createElement(S,{title:"Pace",value:"".concat(p(null!==(t=i.pace.avg)&&void 0!==t?t:0)," min / km")}),r.a.createElement(S,{title:"Elevation",value:"".concat(Number((null!==(a=i.elevation.max)&&void 0!==a?a:0)-(null!==(n=i.elevation.min)&&void 0!==n?n:0)).toFixed(1)," m")}),r.a.createElement(S,{title:"Elapsed Time",value:v(i.elapsedTime)})))},S=function(e){var t=e.title,a=e.value;return r.a.createElement(k.a,{direction:"column"},r.a.createElement(x.a,{className:"title"},t),r.a.createElement(x.a,{className:"value mb-0"},a))},C=a(42),T=a.n(C),F=a(79),L=a(238),B=function(e){var t=function(e){var t=Object(n.useState)(!1),a=Object(m.a)(t,2),r=a[0],i=a[1],c=Object(n.useState)([]),l=Object(m.a)(c,2),o=l[0],s=l[1],d=Object(n.useState)(!0),f=Object(m.a)(d,2),p=f[0],v=f[1],E=Object(n.useState)(),h=Object(m.a)(E,2),b=h[0],g=h[1],y=Object(n.useState)(1),j=Object(m.a)(y,2),w=j[0],N=j[1];return Object(n.useEffect)((function(){o.length===b&&v(!1)}),[o,b]),Object(n.useEffect)((function(){s([]),N(1)}),[e]),{loading:r,activities:o,hasNextPage:p,onLoadMore:function(){var t=Object(F.a)(T.a.mark((function t(){var a,n,r;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i(!0),(a=new URLSearchParams).append("page",w.toString()),a.append("pageSize","5"),""!==e&&"All"!==e&&a.append("type",e),N(w+1),t.next=8,fetch("/activities?"+a.toString());case 8:return n=t.sent,t.next=11,n.json();case 11:r=t.sent,g(r.total),s((function(e){return[].concat(Object(u.a)(e),Object(u.a)(r.data))})),i(!1);case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),totalCount:b}}(e),a=t.loading,r=t.activities,i=t.hasNextPage,c=t.onLoadMore,l=t.totalCount,o=Object(L.a)(),s=o.ref,d=o.inView;return Object(n.useEffect)((function(){if(!a&&d&&i){var e=setTimeout((function(){c()}),100);return function(){clearTimeout(e)}}}),[c,a,d,i]),{ref:s,activities:r,loading:a,hasNextPage:i,totalCount:l}},A=function(e){var t=e.filter,a=B(t),n=a.ref,i=a.activities,c=a.loading,l=a.hasNextPage,o=a.totalCount;return r.a.createElement("div",{role:"feed","aria-label":"Feed of activities sorted by most recent","aria-busy":c},i.map((function(e,t){return r.a.createElement(I,{key:e._id,activity:e,index:t,totalCount:o})})),l&&r.a.createElement("span",{ref:n,style:{height:"1px"}},c&&r.a.createElement(g,null)))},M=a(496),R=Object(E.a)({main:{display:"flex",flexDirection:"column",alignItems:"center",paddingTop:"1rem",paddingLeft:"1rem",paddingRight:"1rem"},mainContent:{maxWidth:"100%",width:"min(50rem, 100%)",paddingBottom:"1rem"},header:{marginBottom:"1.5rem"}}),H=function(){var e=Object(n.useState)(""),t=Object(m.a)(e,2),a=t[0],i=t[1],c=R();return r.a.createElement("main",{className:c.main},r.a.createElement("div",{className:c.mainContent},r.a.createElement("header",{className:c.header},r.a.createElement(k.a,{direction:"row",justify:"between"},r.a.createElement(P,null),r.a.createElement(d,{onFilterChange:i}))),r.a.createElement(A,{filter:a})))},P=function(){return r.a.createElement(l.b,{to:"/activities/upload"},r.a.createElement(M.a,{primary:!0,label:"Upload",fill:"vertical"}))},K=a(495),z=a(483),G=a(484),J=a(488),U=a(85),W=a(86),Y=a(113),V=a(252),_=function(e,t){for(var a=[],n=e;n<=t;n++)a.push(n);return a},Z=function(e){var t=e.points,a=e.distance,n=t.filter((function(e){return e.altitude&&e.distance})).map((function(e){var t=e.altitude,a=e.distance;return{distance:Number(a/1e3).toFixed(1),elevation:Number(t).toFixed(1)}})),i=_(0,a/1e3);return r.a.createElement(z.a,{height:250,width:"100%"},r.a.createElement(G.a,{data:n,margin:{top:10,right:30,left:0,bottom:0}},r.a.createElement(J.a,{strokeDasharray:"3 3"}),r.a.createElement(U.a,{dataKey:"distance",ticks:i,unit:"km",interval:1}),r.a.createElement(W.a,{allowDecimals:!1,unit:"m"}),r.a.createElement(Y.a,{labelFormatter:function(e){return"Distance: ".concat(e,"km")},formatter:function(e){return"".concat(e,"m")}}),r.a.createElement(V.a,{isAnimationActive:!1,type:"monotone",dataKey:"elevation",stroke:"#8884d8",fill:"#8884d8"})))},q=a(489),X=a(254);var $=function(e){var t=e.points.filter((function(e){return e.distance&&e.speed})).map((function(e){return{distance:Number(e.distance/1e3).toFixed(1),pace:1e3/60/Number(e.speed)}}));t=function(e){return e.filter((function(e){return e.pace<=20}))}(t);return r.a.createElement(z.a,{height:250,width:"100%"},r.a.createElement(q.a,{data:t,margin:{top:10,right:30,left:0,bottom:0}},r.a.createElement(J.a,{strokeDasharray:"3 3"}),r.a.createElement(U.a,{dataKey:"distance",allowDecimals:!1,tickCount:4,unit:"km",minTickGap:20}),r.a.createElement(W.a,{allowDecimals:!1,reversed:!0}),r.a.createElement(Y.a,{formatter:function(e){return"".concat(p(60*e)," min / km")},labelFormatter:function(e){return"".concat(e,"km")}}),r.a.createElement(X.a,{type:"monotone",dataKey:"pace",stroke:"#8884d8",dot:!1})))},Q=a(490),ee=a(266),te=function(e){var t=function(e){var t=[];if(!e.length||0===e.length)return t;var a=1,n=e[0].time;e.filter((function(e){return e.distance&&e.time})).forEach((function(e,r){if(!(e.distance<1e3*a)){var i=(new Date(e.time).getTime()-new Date(n).getTime())/1e3;t.push({name:a,value:Number(1e3/i).toFixed(4)}),a++,n=e.time}}));var r=e[e.length-1],i=(new Date(r.time).getTime()-new Date(n).getTime())/1e3,c=r.distance-1e3*(a-1);if(c<100)return t;return t.push({name:a,value:Number(i/c).toFixed(2)}),t}(e.points);return r.a.createElement(z.a,{height:250,width:"100%"},r.a.createElement(Q.a,{data:t},r.a.createElement(J.a,{strokeDasharray:"3 3"}),r.a.createElement(U.a,{dataKey:"name"}),r.a.createElement(W.a,null),r.a.createElement(Y.a,null),r.a.createElement(ee.a,{dataKey:"value",fill:"#6fd450"})))},ae=function(e){var t=e.streamData,a=e.distance,n=t.filter((function(e){return(null===e||void 0===e?void 0:e.heartRate)&&(null===e||void 0===e?void 0:e.distance)})).map((function(e){return{distance:+Number(e.distance/1e3).toFixed(2),heartRate:e.heartRate}})),i=_(0,Number(a/1e3));return r.a.createElement(r.a.Fragment,null,n&&r.a.createElement(z.a,{height:250,width:"100%"},r.a.createElement(G.a,{data:n,margin:{top:10,right:30,left:30,bottom:0}},r.a.createElement(J.a,{strokeDasharray:"3 3"}),r.a.createElement(U.a,{dataKey:"distance",unit:"km",ticks:i}),r.a.createElement(W.a,{allowDecimals:!0,unit:"bpm"}),r.a.createElement(Y.a,null),r.a.createElement(V.a,{isAnimationActive:!1,type:"monotone",dataKey:"heartRate",stroke:"#F87666",fill:"#F87666"}))))},ne=function(){var e=Object(o.f)(),t=Object(o.g)().activityId,a=Object(n.useState)(),i=Object(m.a)(a,2),c=i[0],l=i[1];function u(){return(u=Object(F.a)(T.a.mark((function e(t){var a,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/activities/"+t);case 2:return a=e.sent,e.next=5,a.json();case 5:n=e.sent,l(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(e){u.apply(this,arguments)}(t)}),[t]),r.a.createElement(ie,{activity:c,handleGoBack:function(){e.goBack()}})},re=Object(E.a)({header:{position:"sticky",top:0,borderBottom:"1px solid #e0e0e0",zIndex:1e3,backgroundColor:"white",padding:"1rem",display:"flex",justifyContent:"center"},headerLayout:{display:"grid",gridTemplateColumns:"1fr auto 1fr",justifyContent:"center",maxWidth:"55rem",width:"100%"},marginAuto:{margin:"auto",marginRight:0},statsHeader:{padding:"0rem 1rem"}}),ie=function(e){var t=e.activity,a=e.handleGoBack,n=re();return r.a.createElement("div",{className:"activity-component"},r.a.createElement("div",{className:n.header},r.a.createElement("div",{className:n.headerLayout},r.a.createElement("div",null,r.a.createElement(M.a,{onClick:a,icon:r.a.createElement(K.a,null),label:"Activities",size:"small"})),r.a.createElement(O.a,{level:"3",className:n.marginAuto},(null===t||void 0===t?void 0:t.type)?t.type:"Loading"))),(null===t||void 0===t?void 0:t.polyline)&&r.a.createElement(N,{polyline:t.polyline}),t&&t.streamData?r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a,{level:"2",className:n.statsHeader},"".concat(Object(f.a)(new Date(t.startTime),"EEEE, LLLL d, yyyy")," at ").concat(Object(f.a)(new Date(t.startTime),"HH:mm aaa"))),r.a.createElement(O.a,{level:"3",className:n.statsHeader},"Heart Rate"),r.a.createElement(ae,{streamData:t.streamData,distance:t.distance}),r.a.createElement(O.a,{level:"3",className:n.statsHeader},"Elevation"),r.a.createElement(Z,{points:t.streamData,distance:t.distance}),r.a.createElement(O.a,{level:"3",className:n.statsHeader},"Pace"),r.a.createElement($,{points:t.streamData}),r.a.createElement(O.a,{level:"3",className:n.statsHeader},"Splits"),r.a.createElement(te,{points:t.streamData})):r.a.createElement(g,null))},ce=a(110),le=a.n(ce),oe={baseUrl:"https://t9mdzi08qi.execute-api.ap-southeast-2.amazonaws.com/Staging",getAllActivities:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n="All"===a?null:a;return le.a.get(this.baseUrl+"/activities",{params:{pageNumber:e,pageSize:t,type:n}})},getActivity:function(e){return le.a.get(this.baseUrl+"/activities/"+e)},upload:function(e){var t=new FormData;return t.append("file",e,e.name),le.a.post(this.baseUrl+"/upload",t)},getFilters:function(){return le.a.get("/filters")}},me=a(497),ue=Object(E.a)({container:{display:"flex",justifyContent:"center",width:"100%"},content:{width:"calc(100% - 2rem)",maxWidth:"30rem"},actions:{display:"flex",flexWrap:"wrap",justifyContent:"space-between"},fileInput:{marginTop:"1rem",marginBottom:"1rem"},actionBtn:{minWidth:"calc(50% - 0.5rem)",marginBottom:"1rem"}}),se=function(){var e=Object(o.f)(),t=ue(),a=Object(n.useState)(!1),i=Object(m.a)(a,2),c=i[0],u=i[1],s=Object(n.useState)(),d=Object(m.a)(s,2),f=d[0],p=d[1];function v(){return(v=Object(F.a)(T.a.mark((function t(){return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!f){t.next=6;break}return u(!0),t.next=4,oe.upload(f);case 4:u(!1),e.push("/activities");case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return r.a.createElement("div",{className:t.container},r.a.createElement("div",{className:t.content},r.a.createElement(O.a,{id:"inputGroupFileAddon01",level:"2"},"Upload"),r.a.createElement(x.a,null,"Accepted file types: '.gpx'"),r.a.createElement("div",{className:t.fileInput},r.a.createElement(me.a,{onChange:function(e){var t,a=null===(t=e.target.files)||void 0===t?void 0:t.item(0);a&&p(a)}})),r.a.createElement("div",{className:t.actions},r.a.createElement(l.b,{to:"/activities",className:t.actionBtn},r.a.createElement(M.a,{type:"button",label:"Go Back",fill:"horizontal"})),r.a.createElement(M.a,{label:"Submit",type:"submit",className:t.actionBtn,onClick:function(){return v.apply(this,arguments)},disabled:!f})),c&&r.a.createElement(g,null)))},de=function(){var e=Object(o.h)().path;return r.a.createElement(o.c,null,r.a.createElement(o.a,{exact:!0,path:e},r.a.createElement(H,null)),r.a.createElement(o.a,{path:"".concat(e,"/upload")},r.a.createElement(se,null)),r.a.createElement(o.a,{path:"".concat(e,"/:activityId")},r.a.createElement(ne,null)))},fe=a(498);var pe=function(){return r.a.createElement(fe.a,null,r.a.createElement(l.a,null,r.a.createElement(o.c,null,r.a.createElement(o.a,{path:"/activities"},r.a.createElement(de,null)),r.a.createElement(o.a,{path:"/",exact:!0},r.a.createElement(de,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(265);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(pe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[276,1,2]]]);
//# sourceMappingURL=main.d3864cfc.chunk.js.map