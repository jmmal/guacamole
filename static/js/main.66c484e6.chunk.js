(this.webpackJsonpguacamole=this.webpackJsonpguacamole||[]).push([[0],{272:function(e,t,a){},447:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),c=a(69),r=a.n(c),o=(a(272),a(52)),s=a(29),l=a(16),u=a(108),j=a(467),d=a(3),m=function(e){var t=e.onFilterChange,a=function(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),a=t[0],i=t[1];return Object(n.useEffect)((function(){fetch("https://t9mdzi08qi.execute-api.ap-southeast-2.amazonaws.com/Staging/filters").then((function(e){return e.json()})).then((function(e){return i(e)}))}),[]),{filters:a}}().filters,i=Object(n.useState)(),c=Object(l.a)(i,2),r=c[0],o=c[1],s=Object(n.useState)([]),m=Object(l.a)(s,2),b=m[0],h=m[1];Object(n.useEffect)((function(){if(0!==a.length){var e=a.reduce((function(e,t){return e+t.total}),0),t={label:"All (".concat(e,")"),value:"All"},n=[t].concat(Object(u.a)(a.map((function(e){return{label:e.type+" (".concat(e.total,")"),value:e.type}}))));o(t),h(n)}}),[a]);return Object(d.jsx)(j.a,{a11yTitle:"Filter by activity type",options:b,labelKey:"label",placeholder:"-",value:r,size:"small",onChange:function(e){o(e.option),t(e.option.value)}})},b=a(466),h=function(e){var t=Math.floor(e/60),a="".concat(Math.floor(e-60*t));return"".concat(t,":").concat(a.padStart(2,"0"))},p=function(e){var t=Math.floor(e/60),a=Math.floor(t/60),n=Math.floor(e-60*t);return a>=1?"".concat(a,"h ").concat(t%60,"m"):"".concat(t,"m ").concat(n,"s")},f=function(e){var t=e.max,a=void 0===t?0:t,n=e.min;return(a-(void 0===n?0:n)).toFixed(1).toString()+"m"},x=function(e,t){var a,n=new Date(e);console.log(n);var i=n.getHours();console.log(i);var c="Morning";i>=12&&(c="Lunch"),i>=14&&(c="Afternoon"),i>=16&&(c="Evening"),i>=21&&(c="Night");var r=null!==(a=O.get(t))&&void 0!==a?a:"Workout";return console.log("".concat(c," ").concat(r)),"".concat(c," ").concat(r)},O=new Map([["Running","Run"],["Cycling","Ride"],["Hiking","Hike"]]),v=a(34),g=a(228),y=Object(v.a)({container:{width:"100%",display:"flex",justifyContent:"center",margin:"2rem 0"}}),w=function(){var e=y();return Object(d.jsx)("div",{className:e.container,children:Object(d.jsx)(g.BeatLoader,{size:"30px",margin:"4px",color:"#7D4CDB"})})},N=a(132),k=a(229),S=Object(v.a)({map:{height:"25rem"}}),D=function(e){var t=e.polyline,a=Object(n.useRef)(null),i=S();Object(n.useEffect)((function(){c()}));var c=function(){var e=k.toGeoJSON(t),n=function(e){var t=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return e.reduce((function(e,t){return[Math.min(t[0],e[0]),Math.min(t[1],e[1]),Math.max(t[0],e[2]),Math.max(t[1],e[3])]}),t)}(e.coordinates),i=new N.Map({container:a.current||"",style:"mapbox://styles/mapbox/outdoors-v11",bounds:new N.LngLatBounds(n),fitBoundsOptions:{padding:{top:40,bottom:40,left:40,right:40}},accessToken:"pk.eyJ1Ijoiam1tYWwiLCJhIjoiY2tobXJhbHpqMHZmYTJwbnVwY21oaXl6byJ9.CZy7LN4IJff9dD5-orrPHw"});i.addControl(new N.NavigationControl),i.scrollZoom.disable(),i.on("load",(function(){i.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:e.coordinates}}}),i.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#008DD5","line-width":4}})}))};return Object(d.jsx)("div",{ref:a,className:i.map})},T=a(476),C=a(475),I=Object(v.a)({image:{width:"100%"},preview:{borderRadius:3,border:"1px solid #e2e2e2",boxShadow:"0px 8px 24px rgba(13,13,18,0.04)",padding:"1rem 1rem 1rem 1rem",marginBottom:"1rem"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",marginBottom:"0.5rem"},stats:{display:"flex",flexWrap:"wrap",margin:"0 -1rem"}}),E=function(e){var t,a=e.activity,n=e.index,i=Object(s.f)(),c=I();function r(){i.push("/activities/".concat(a._id))}var o,l=a.heartRate,u=l.avg,j=l.max;return Object(d.jsxs)("article",{className:c.preview,"aria-posinset":n,tabIndex:0,onClick:r,onKeyDown:function(e){"ENTER"===e.key&&r()},children:[Object(d.jsxs)("div",{className:c.header,children:[Object(d.jsx)(T.a,{margin:"none",level:"4",children:Object(b.a)(new Date(a.startTime),"EEEE, LLLL d, yyyy")}),Object(d.jsx)(C.a,{children:x(a.startTime,a.type)})]}),a.imageURL&&Object(d.jsx)("img",{src:a.imageURL,alt:"Activity GPS preview",className:c.image}),Object(d.jsxs)("div",{className:c.stats,children:[Object(d.jsx)(F,{title:"Distance",value:(o=a.distance,Number(o/1e3).toFixed(2)+"km")}),Object(d.jsx)(F,{title:"Pace",value:"".concat(h(null!==(t=a.pace.avg)&&void 0!==t?t:0),"/km")}),Object(d.jsx)(F,{title:"Elevation",value:f(a.elevation)}),Object(d.jsx)(F,{title:"Elapsed Time",value:p(a.elapsedTime)}),a.heartRate.avg&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(F,{title:"Avg Heart Rate",value:"".concat(u,"bpm")}),Object(d.jsx)(F,{title:"Max Heart Rate",value:"".concat(j,"bpm")})]})]})]})},L=Object(v.a)({title:{fontSize:11,color:"#626262",marginBottom:0,marginTop:8},stat:{margin:0},column:{display:"flex",flexDirection:"column",margin:"0 1rem"}}),F=function(e){var t=e.title,a=e.value,n=L();return Object(d.jsxs)("div",{className:n.column,children:[Object(d.jsx)("p",{className:n.title,children:t}),Object(d.jsx)("p",{className:n.stat,children:a})]})},R=a(42),B=a.n(R),A=a(79),H=a(230),M=function(e){var t=function(e){var t=Object(n.useState)(!1),a=Object(l.a)(t,2),i=a[0],c=a[1],r=Object(n.useState)([]),o=Object(l.a)(r,2),s=o[0],j=o[1],d=Object(n.useState)(!0),m=Object(l.a)(d,2),b=m[0],h=m[1],p=Object(n.useState)(),f=Object(l.a)(p,2),x=f[0],O=f[1],v=Object(n.useState)(1),g=Object(l.a)(v,2),y=g[0],w=g[1];return Object(n.useEffect)((function(){s.length===x&&h(!1)}),[s,x]),Object(n.useEffect)((function(){j([]),w(1),h(!0),O(void 0)}),[e]),{loading:i,activities:s,hasNextPage:b,onLoadMore:function(){var t=Object(A.a)(B.a.mark((function t(){var a,n,i;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c(!0),(a=new URLSearchParams).append("page",y.toString()),a.append("pageSize","5"),""!==e&&"All"!==e&&a.append("type",e),w(y+1),t.next=8,fetch("https://t9mdzi08qi.execute-api.ap-southeast-2.amazonaws.com/Staging/activities?"+a.toString());case 8:return n=t.sent,t.next=11,n.json();case 11:i=t.sent,O(i.total),j((function(e){return[].concat(Object(u.a)(e),Object(u.a)(i.data))})),c(!1);case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),totalCount:x}}(e),a=t.loading,i=t.activities,c=t.hasNextPage,r=t.onLoadMore,o=t.totalCount,s=Object(H.a)(),j=s.ref,d=s.inView;return Object(n.useEffect)((function(){if(!a&&d&&c){var e=setTimeout((function(){r()}),100);return function(){clearTimeout(e)}}}),[r,a,d,c]),{ref:j,activities:i,loading:a,hasNextPage:c,totalCount:o}},z=Object(v.a)({container:{paddingBottom:"2rem"}}),P=function(e){var t=e.filter,a=M(t),n=a.ref,i=a.activities,c=a.loading,r=a.hasNextPage,o=a.totalCount,s=z();return Object(d.jsxs)("div",{role:"feed","aria-label":"Feed of activities sorted by most recent","aria-busy":c,className:s.container,children:[i.map((function(e,t){return Object(d.jsx)(E,{activity:e,index:t,totalCount:o},e._id)})),c&&Object(d.jsx)(w,{}),r&&Object(d.jsx)("span",{ref:n})]})},W=a(474),K=a(471),G=Object(v.a)({main:{display:"flex",flexDirection:"column",alignItems:"center",paddingTop:"1rem",paddingLeft:"1rem",paddingRight:"1rem"},mainContent:{maxWidth:"100%",width:"min(50rem, 100%)"},header:{marginBottom:"1.5rem"}}),J=function(){var e=Object(n.useState)(""),t=Object(l.a)(e,2),a=t[0],i=t[1],c=G();return Object(d.jsx)("main",{className:c.main,children:Object(d.jsxs)("div",{className:c.mainContent,children:[Object(d.jsx)("header",{className:c.header,children:Object(d.jsxs)(W.a,{direction:"row",justify:"between",children:[Object(d.jsx)(U,{}),Object(d.jsx)(m,{onFilterChange:i})]})}),Object(d.jsx)(P,{filter:a})]})})},U=function(){return Object(d.jsx)(o.b,{to:"/activities/upload",children:Object(d.jsx)(K.a,{primary:!0,label:"Upload",fill:"vertical"})})},Y=a(470),V=a(458),_=a(459),q=a(463),Z=a(85),X=a(86),$=a(112),Q=a(244),ee=function(e,t){for(var a=[],n=e;n<=t;n++)a.push(n);return a},te=function(e){var t=e.points,a=e.distance,n=t.filter((function(e){return e.altitude&&e.distance})).map((function(e){var t=e.altitude,a=e.distance;return{distance:Number(a/1e3).toFixed(1),elevation:Number(t).toFixed(1)}})),i=ee(0,a/1e3);return Object(d.jsx)(V.a,{height:250,width:"100%",children:Object(d.jsxs)(_.a,{data:n,margin:{top:10,right:30,left:0,bottom:0},children:[Object(d.jsx)(q.a,{strokeDasharray:"3 3"}),Object(d.jsx)(Z.a,{dataKey:"distance",ticks:i,unit:"km",interval:1}),Object(d.jsx)(X.a,{allowDecimals:!1,unit:"m"}),Object(d.jsx)($.a,{labelFormatter:function(e){return"Distance: ".concat(e,"km")},formatter:function(e){return"".concat(e,"m")}}),Object(d.jsx)(Q.a,{isAnimationActive:!1,type:"monotone",dataKey:"elevation",stroke:"#8884d8",fill:"#8884d8"})]})})},ae=a(464),ne=a(246);var ie=function(e){var t=e.points.filter((function(e){return e.distance&&e.speed})).map((function(e){return{distance:Number(e.distance/1e3).toFixed(1),pace:16.666666666666668/Number(e.speed)}}));t=function(e){return e.filter((function(e){return e.pace<=20}))}(t);return Object(d.jsx)(V.a,{height:250,width:"100%",children:Object(d.jsxs)(ae.a,{data:t,margin:{top:10,right:30,left:0,bottom:0},children:[Object(d.jsx)(q.a,{strokeDasharray:"3 3"}),Object(d.jsx)(Z.a,{dataKey:"distance",allowDecimals:!1,tickCount:4,unit:"km",minTickGap:20}),Object(d.jsx)(X.a,{allowDecimals:!1,reversed:!0}),Object(d.jsx)($.a,{formatter:function(e){return"".concat(h(60*e)," min / km")},labelFormatter:function(e){return"".concat(e,"km")}}),Object(d.jsx)(ne.a,{type:"monotone",dataKey:"pace",stroke:"#8884d8",dot:!1})]})})},ce=a(465),re=a(258),oe=function(e){var t=function(e){var t=[];if(!e.length||0===e.length)return t;var a=1,n=e[0].time;e.filter((function(e){return e.distance&&e.time})).forEach((function(e,i){if(!(e.distance<1e3*a)){var c=(new Date(e.time).getTime()-new Date(n).getTime())/1e3;t.push({name:a,value:Number(1e3/c).toFixed(4)}),a++,n=e.time}}));var i=e[e.length-1],c=(new Date(i.time).getTime()-new Date(n).getTime())/1e3,r=i.distance-1e3*(a-1);if(r<100)return t;return t.push({name:a,value:Number(c/r).toFixed(2)}),t}(e.points);return Object(d.jsx)(V.a,{height:250,width:"100%",children:Object(d.jsxs)(ce.a,{data:t,children:[Object(d.jsx)(q.a,{strokeDasharray:"3 3"}),Object(d.jsx)(Z.a,{dataKey:"name"}),Object(d.jsx)(X.a,{}),Object(d.jsx)($.a,{}),Object(d.jsx)(re.a,{dataKey:"value",fill:"#6fd450"})]})})},se=function(e){var t=e.streamData,a=e.distance,n=t.filter((function(e){return(null===e||void 0===e?void 0:e.heartRate)&&(null===e||void 0===e?void 0:e.distance)})).map((function(e){return{distance:+Number(e.distance/1e3).toFixed(2),heartRate:e.heartRate}})),i=ee(0,Number(a/1e3));return Object(d.jsx)(d.Fragment,{children:n&&Object(d.jsx)(V.a,{height:250,width:"100%",children:Object(d.jsxs)(_.a,{data:n,margin:{top:10,right:30,left:30,bottom:0},children:[Object(d.jsx)(q.a,{strokeDasharray:"3 3"}),Object(d.jsx)(Z.a,{dataKey:"distance",unit:"km",ticks:i}),Object(d.jsx)(X.a,{allowDecimals:!0,unit:"bpm"}),Object(d.jsx)($.a,{}),Object(d.jsx)(Q.a,{isAnimationActive:!1,type:"monotone",dataKey:"heartRate",stroke:"#F87666",fill:"#F87666"})]})})})},le="https://t9mdzi08qi.execute-api.ap-southeast-2.amazonaws.com/Staging",ue=function(){var e=Object(s.f)(),t=Object(s.g)().activityId,a=Object(n.useState)(),i=Object(l.a)(a,2),c=i[0],r=i[1];function o(){return(o=Object(A.a)(B.a.mark((function e(t){var a,n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(le+"/activities/"+t);case 2:return a=e.sent,e.next=5,a.json();case 5:n=e.sent,r(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(e){o.apply(this,arguments)}(t)}),[t]),Object(d.jsx)(de,{activity:c,handleGoBack:function(){e.goBack()}})},je=Object(v.a)({header:{position:"sticky",top:0,borderBottom:"1px solid #e0e0e0",zIndex:1e3,backgroundColor:"white",padding:"1rem",display:"flex",justifyContent:"center"},headerLayout:{display:"grid",gridTemplateColumns:"1fr auto 1fr",justifyContent:"center",maxWidth:"55rem",width:"100%"},marginAuto:{margin:"auto",marginRight:0},statsHeader:{padding:"0rem 1rem"}}),de=function(e){var t=e.activity,a=e.handleGoBack,n=je();return Object(d.jsxs)("div",{className:"activity-component",children:[Object(d.jsx)("div",{className:n.header,children:Object(d.jsxs)("div",{className:n.headerLayout,children:[Object(d.jsx)("div",{children:Object(d.jsx)(K.a,{onClick:a,icon:Object(d.jsx)(Y.a,{}),label:"Activities",size:"small"})}),Object(d.jsx)(T.a,{level:"3",className:n.marginAuto,children:(null===t||void 0===t?void 0:t.type)?t.type:"Loading"})]})}),(null===t||void 0===t?void 0:t.polyline)&&Object(d.jsx)(D,{polyline:t.polyline}),t&&t.streamData?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(T.a,{level:"2",className:n.statsHeader,children:"".concat(Object(b.a)(new Date(t.startTime),"EEEE, LLLL d, yyyy")," at ").concat(Object(b.a)(new Date(t.startTime),"HH:mm aaa"))}),Object(d.jsx)(T.a,{level:"3",className:n.statsHeader,children:"Heart Rate"}),Object(d.jsx)(se,{streamData:t.streamData,distance:t.distance}),Object(d.jsx)(T.a,{level:"3",className:n.statsHeader,children:"Elevation"}),Object(d.jsx)(te,{points:t.streamData,distance:t.distance}),Object(d.jsx)(T.a,{level:"3",className:n.statsHeader,children:"Pace"}),Object(d.jsx)(ie,{points:t.streamData}),Object(d.jsx)(T.a,{level:"3",className:n.statsHeader,children:"Splits"}),Object(d.jsx)(oe,{points:t.streamData})]}):Object(d.jsx)(w,{})]})},me=a(472),be="https://t9mdzi08qi.execute-api.ap-southeast-2.amazonaws.com/Staging",he=Object(v.a)({container:{display:"flex",justifyContent:"center",width:"100%"},content:{width:"calc(100% - 2rem)",maxWidth:"30rem"},actions:{display:"flex",flexWrap:"wrap",justifyContent:"space-between"},fileInput:{marginTop:"1rem",marginBottom:"1rem"},actionBtn:{minWidth:"calc(50% - 0.5rem)",marginBottom:"1rem"}}),pe=function(){var e=Object(s.f)(),t=he(),a=Object(n.useState)(!1),i=Object(l.a)(a,2),c=i[0],r=i[1],u=Object(n.useState)(),j=Object(l.a)(u,2),m=j[0],b=j[1];function h(){return(h=Object(A.a)(B.a.mark((function t(){var a,n,i;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!m){t.next=14;break}return r(!0),(a=new URLSearchParams).append("filename",m.name),t.next=6,fetch(be+"/upload?"+a.toString());case 6:return n=t.sent,t.next=9,n.json();case 9:return i=t.sent,t.next=12,fetch(i.uploadURL,{method:"PUT",headers:{"Content-Type":"binary/octet-stream"},body:m});case 12:r(!1),e.push("/activities");case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(d.jsx)("div",{className:t.container,children:Object(d.jsxs)("div",{className:t.content,children:[Object(d.jsx)(T.a,{id:"inputGroupFileAddon01",level:"2",children:"Upload"}),Object(d.jsx)(C.a,{children:"Accepted file types: '.gpx'"}),Object(d.jsx)("div",{className:t.fileInput,children:Object(d.jsx)(me.a,{onChange:function(e){var t,a=null===(t=e.target.files)||void 0===t?void 0:t.item(0);a&&b(a)}})}),Object(d.jsxs)("div",{className:t.actions,children:[Object(d.jsx)(o.b,{to:"/activities",className:t.actionBtn,children:Object(d.jsx)(K.a,{type:"button",label:"Go Back",fill:"horizontal"})}),Object(d.jsx)(K.a,{label:"Submit",type:"submit",className:t.actionBtn,onClick:function(){return h.apply(this,arguments)},disabled:!m})]}),c&&Object(d.jsx)(w,{})]})})},fe=function(){var e=Object(s.h)().path;return Object(d.jsxs)(s.c,{children:[Object(d.jsx)(s.a,{exact:!0,path:e,children:Object(d.jsx)(J,{})}),Object(d.jsx)(s.a,{path:"".concat(e,"/upload"),children:Object(d.jsx)(pe,{})}),Object(d.jsx)(s.a,{path:"".concat(e,"/:activityId"),children:Object(d.jsx)(ue,{})})]})},xe=a(473);var Oe=function(){return Object(d.jsx)(xe.a,{children:Object(d.jsx)(o.a,{children:Object(d.jsxs)(s.c,{children:[Object(d.jsx)(s.a,{path:"/activities",children:Object(d.jsx)(fe,{})}),Object(d.jsx)(s.a,{path:"/",exact:!0,children:Object(d.jsx)(fe,{})})]})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(257);r.a.render(Object(d.jsx)(i.a.StrictMode,{children:Object(d.jsx)(Oe,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[447,1,2]]]);
//# sourceMappingURL=main.66c484e6.chunk.js.map